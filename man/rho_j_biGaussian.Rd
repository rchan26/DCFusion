% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bivariate_Gaussian_generalised_BF.R
\name{rho_j_biGaussian}
\alias{rho_j_biGaussian}
\title{rho_j Importance Sampling Step}
\usage{
rho_j_biGaussian(
  particle_set,
  m,
  time_mesh,
  mean_vecs,
  sd_vecs,
  corrs,
  betas,
  precondition_matrices,
  inv_precondition_matrices,
  Lambda,
  resampling_method = "multi",
  ESS_threshold = 0.5,
  sub_posterior_means = NULL,
  adaptive_mesh = FALSE,
  adaptive_mesh_parameters = NULL,
  diffusion_estimator = "Poisson",
  beta_NB = 10,
  gamma_NB_n_points = 2,
  seed = NULL,
  n_cores = parallel::detectCores()
)
}
\arguments{
\item{particle_set}{particles set prior to Q importance sampling step}

\item{m}{number of sub-posteriors to combine}

\item{time_mesh}{time mesh used in Bayesian Fusion}

\item{mean_vecs}{list of length m, where mean_vecs[[c]] is a vector of 
length 2 for the mean of sub-posterior c}

\item{sd_vecs}{list of length m, where sd_vecs[[c]] is a vector of length 2
for the standard deviation of sub-posterior c}

\item{corrs}{vector of length m, where corrs[c] give the correlation value
between component 1 and component 2 for sub-posterior c}

\item{betas}{vector of length m, where betas[c] is the inverse temperature 
value for c-th posterior}

\item{precondition_matrices}{list of length m, where precondition_matrices[[c]]
is the precondition matrix for sub-posterior c}

\item{inv_precondition_matrices}{list of length m, where inv_precondition_matrices[[c]]
is the inverse precondition matrix for sub-posterior c}

\item{Lambda}{inverse of the sum of the inverse precondition matrices (which
can be computed using inverse_sum_matrices(inv_precondition_matrices))}

\item{resampling_method}{method to be used in resampling, default is multinomial
resampling ('multi'). Other choices are stratified
resampling ('strat'), systematic resampling ('system'),
residual resampling ('resid')}

\item{ESS_threshold}{number between 0 and 1 defining the proportion of the
number of samples that ESS needs to be lower than for
resampling (i.e. resampling is carried out only when
ESS < N*ESS_threshold)}

\item{sub_posterior_means}{matrix with m rows and 2 columns, where sub_posterior_means[c,]
is the sub-posterior mean of sub-posterior c}

\item{adaptive_mesh}{logical value to indicate if an adaptive mesh is used
(default is FALSE)}

\item{adaptive_mesh_parameters}{list of parameters used for adaptive mesh}

\item{diffusion_estimator}{choice of unbiased estimator for the Exact Algorithm
between "Poisson" (default) for Poisson estimator
and "NB" for Negative Binomial estimator}

\item{beta_NB}{beta parameter for Negative Binomial estimator (default 10)}

\item{gamma_NB_n_points}{number of points used in the trapezoidal estimation
of the integral found in the mean of the negative
binomial estimator (default is 2)}

\item{seed}{seed number - default is NULL, meaning there is no seed}

\item{n_cores}{number of cores to use}
}
\value{
A list with components:
\describe{
  \item{particle_set}{updated particle set after the iterative rho_j steps}
  \item{proposed_samples}{proposal samples for the last time step}
  \item{time}{elapsed time of each step of the algorithm}
  \item{ESS}{effective sample size of the particles after each step}
  \item{CESS}{conditional effective sample size of the particles after each step}
  \item{resampled}{boolean value to indicate if particles were resampled
                   after each time step}
  \item{E_nu_j}{Approximation of the average variation of the trajectories
                at each time step}
}
}
\description{
rho_j Importance Sampling weighting for bivariate Gaussian distributions
}
